<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Transaction Journal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link th:href="@{/css/index.css}" rel="stylesheet" />
    <script th:src="@{/js/common.js}" type="text/javascript"></script>
</head>
<body>

<div class="container">
    <aside class="sidebar">
        <h3>Персональні фінанси</h3>
        <nav>
            <ul>
                <li><a href="/">Витрати</a></li>
                <li><a href="/income">Доходи</a></li>
                <li><a href="/assets">Активи</a></li>
                <li><a href="/transactions" class="active">Журнал транзакцій</a></li>
                <li><a href="#" >Налаштування</a></li>
            </ul>
        </nav>
    </aside>

    <main class="dashboard-content">
        <header class="topbar">
            <h2>Журнал транзакцій</h2>
        </header>

        <section class="main-panels">
            <div>
                <form method="get" th:action="@{/transactions}">
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <select class="form-select" name="typeFilter">
                                <option value="">All Types</option>
                                <option value="INCOME" th:selected="${typeFilter == 'INCOME'}">INCOME</option>
                                <option value="EXPENSE" th:selected="${typeFilter == 'EXPENSE'}">EXPENSE</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <input class="form-control" type="text" name="categoryFilter" placeholder="Category" th:value="${categoryFilter}">
                        </div>
                        <div class="col-md-2">
                            <input class="form-control" type="text" name="currencyFilter" placeholder="Currency" th:value="${currencyFilter}">
                        </div>
                        <div class="col-md-2">
                            <input class="form-control" type="date" name="startDate" th:value="${startDate}">
                        </div>
                        <div class="col-md-2">
                            <input class="form-control" type="date" name="endDate" th:value="${endDate}">
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-primary w-100" type="submit">Apply Filters</button>
                        </div>
                    </div>

                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th>
                                <a th:href="@{/transactions(sort='type', direction=${sort == 'type' and direction == 'asc' ? 'desc' : 'asc'},
                                    typeFilter=${typeFilter}, categoryFilter=${categoryFilter}, currencyFilter=${currencyFilter}, startDate=${startDate}, endDate=${endDate})}">
                                    Type
                                    <span th:if="${sort == 'type'}" th:text="${direction == 'asc' ? '▲' : '▼'}"></span>
                                </a>
                            </th>
                            <th>
                                <a th:href="@{/transactions(sort='operationDate', direction=${sort == 'operationDate' and direction == 'asc' ? 'desc' : 'asc'},
                                    typeFilter=${typeFilter}, categoryFilter=${categoryFilter}, currencyFilter=${currencyFilter}, startDate=${startDate}, endDate=${endDate})}">
                                    Date
                                    <span th:if="${sort == 'operationDate'}" th:text="${direction == 'asc' ? '▲' : '▼'}"></span>
                                </a>
                            </th>
                            <th>
                                <a th:href="@{/transactions(sort='category', direction=${sort == 'category' and direction == 'asc' ? 'desc' : 'asc'},
                                    typeFilter=${typeFilter}, categoryFilter=${categoryFilter}, currencyFilter=${currencyFilter}, startDate=${startDate}, endDate=${endDate})}">
                                    Category
                                    <span th:if="${sort == 'category'}" th:text="${direction == 'asc' ? '▲' : '▼'}"></span>
                                </a>
                            </th>
                            <th>
                                <a th:href="@{/transactions(sort='amount', direction=${sort == 'amount' and direction == 'asc' ? 'desc' : 'asc'},
                                    typeFilter=${typeFilter}, categoryFilter=${categoryFilter}, currencyFilter=${currencyFilter}, startDate=${startDate}, endDate=${endDate})}">
                                    Amount
                                    <span th:if="${sort == 'amount'}" th:text="${direction == 'asc' ? '▲' : '▼'}"></span>
                                </a>
                            </th>
                            <th>
                                <a th:href="@{/transactions(sort='currency', direction=${sort == 'currency' and direction == 'asc' ? 'desc' : 'asc'},
                                    typeFilter=${typeFilter}, categoryFilter=${categoryFilter}, currencyFilter=${currencyFilter}, startDate=${startDate}, endDate=${endDate})}">
                                    Currency
                                    <span th:if="${sort == 'currency'}" th:text="${direction == 'asc' ? '▲' : '▼'}"></span>
                                </a>
                            </th>
                            <th>Description</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:if="${transactions.empty}">
                            <td colspan="6">No transactions found.</td>
                        </tr>
                        <tr th:each="transaction : ${transactions}">
                            <td th:text="${transaction.type}"></td>
                            <td th:text="${transaction.operationDate}"></td>
                            <td th:text="${transaction.category}"></td>
                            <td th:text="${transaction.amount}"></td>
                            <td th:text="${transaction.currency}"></td>
                            <td th:text="${transaction.description}"></td>
                        </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </section>

        <footer class="footer">
            <div class="footer-content">
                <nav class="footer-links">
                    <a href="/" class="btn btn-outline-secondary">На головну</a>
                </nav>
            </div>
        </footer>
    </main>
</div>

</body>
</html>
